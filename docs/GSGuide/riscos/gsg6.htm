<html>
<head>
  <meta http-equiv=Content-Type content="text/html; charset=utf-8">
  <link href="gsguide.css" rel="stylesheet" type="text/css" />
  <title>Further steps in spreadsheets</title>
</head>
<body>
  <!-- This Source Code Form is subject to the terms of the Mozilla Public
     - License, v. 2.0. If a copy of the MPL was not distributed with this
     - file, You can obtain one at http://mozilla.org/MPL/2.0/. -->
  <!-- Copyright (C) 1994-1998 Colton Software Limited
     - Copyright (C) 1998-2015 R W Colton -->
<div class="navheader">
<table width="100%" summary="Navigation header">
<tr>
<td width="20%" align="left"><a accesskey="p" href="gsg5.htm">Prev</a></td>
<th width="60%" align="center">Fireworkz and Fireworkz Pro<br />Getting Started Guide for RISC&nbsp;OS</th>
<td width="20%" align="right"> <a accesskey="n" href="gsg7.htm">Next</a></td>
</tr>
</table>
<hr/>
</div>

<h1>Further steps in spreadsheets</h1>

<p>This chapter introduces formulae and shows you how to write them. It
introduces the operators and functions which you need to use in formulae and
shows you the ways Fireworkz can help you to write formulae quickly and easily.</p>

<h2>Using functions</h2>

<p>Load the spreadsheet <var>exams</var> from the <var>Tutorial</var> directory.
You will see a list of class members and their marks in four exams.</p>

<p>You need to calculate the average mark for each pupil, and to award them
each a single grade based on this average mark. You then need to work out the
number of pupils receiving each grade, and the percentage of the class
receiving each grade.</p>

<h3>The function selector</h3>

<p>In the previous chapter you added columns of numbers using the
<span class="csguide-toolbar-button">Autosum</span> button.
You saw that this created a formula which you could read on the formula line. 
In this chapter, you will be entering formulae directly on the formula line.
Note that unlike text and numbers, you cannot enter a formula directly into a
cell - you have to use the formula line.</p>

<h4>Working out an average</h4>

<p>The first step is to work out the average number of marks earned by each
student:</p>

<ol>
<li>Click in cell G3. You need to add the <strong>avg()</strong> function to
this cell. You can type in functions directly, but an easier method is to use
the function selector.</li>

<li>Click in the formula line to place the caret appear there. You can also do
this by pressing the
<span class="csguide-key">F2</span> function key.</li>

<img class="csguide-lhs-img" src="images/tbar_function_selector.png" />
<li>Click the
<span class="csguide-toolbar-button">Function selector</span> button on the toolbar.</li>

<li>Choose
<span class="csguide-menu-option">Quick...</span> from the function selector
menu by clicking on it. You will see a short list of functions.</li>

<li>Double-click on the <strong>avg(list)</strong> entry in this list.
It will appear on the formula line.</li>

<li>The word <span class="csguide-parameter">list</span> is called the
<em>parameter</em> to the function.
You need to replace it with the actual data on which the function will operate.
The <strong>avg()</strong> function needs a list of numbers to operate
on. You could supply a list of individual cell references, but in this case you
will supply a range, indicating that the function should operate on the data
in all the cells contained between, and including, the two cell references
given.

<div class="csguide-li-div">You could enter the range details by typing in the top left and bottom right cell referencess in the range, but it is easier to use the mouse.</div></li>

<li>Select the range of cells starting at cell B3 and ending at cell E3.
You will see these cell references appear between the brackets in the formula
on the formula line, replacing
<span class="csguide-parameter">list</span>.</li>

<img class="csguide-lhs-img" src="images/tbar_tick.png" />
<li>Your formula is now complete. Click the
<span class="csguide-toolbar-button">Tick</span> button on the toolbar or press
<span class="csguide-key">Return</span> to enter the formula. You will see the result 76.75 appear in the cell.</li>
</ol>

<h4>If you make a mistake</h4>

<p>If you make a mistake and the correct result does not appear, then you need
to change the formula:</p>

<ol>
<li>Click in cell G3.</li>

<li>Click in the formula line to place the caret appear there or press
<span class="csguide-key">F2</span>.</li>

<li>Delete the current formula.</li>

<li>Type in the correct formula:

<div class="csguide-li-div"><kbd>avg(b3e3)</kbd></div></li>

<img class="csguide-lhs-img" src="images/tbar_tick.png" />
<li>Click the
<span class="csguide-toolbar-button">Tick</span> button on the toolbar or press
<span class="csguide-key">Return</span> to enter the corrected formula.</li>
</ol>

<h4>Repeating a calculation</h4>

<img class="csguide-lhs-img" src="images/tbar_fill_right.png" />
<p>You need to perform the same calculation for all the students in the class.
This can be done using one of the
<span class="csguide-toolbar-button">Fill</span> buttons.</p>

<img class="csguide-lhs-img" src="images/tbar_fill_down.png" />
<p>When you use a
<span class="csguide-toolbar-button">Fill</span> button to copy a formula,
it updates the formula in each column or row, so that the data it operates on
has the same relative position to each cell containing the formula.
So when our formula appears in row 4, it will calculate the average value in
row 4, and so on:</p>

<ol>
<li>Select the range of cells from cell G3 down to cell G18.</li>

<img class="csguide-lhs-img" src="images/tbar_fill_down.png" />
<li>Now click the
<span class="csguide-toolbar-button">Fill down</span> button (because you are
filling down a column). The column will fill with the average mark for each
student.</li>
</ol>

<p>You can check the formulae which have been created by clicking on any of the
cells in column G and looking at the formula which appears in the formula line.</p>

<h3>The if() function</h3>

<p>The next stage is to assign a grade to each student, based on their average
mark. The school operates the following formula:</p>

<table style="margin-left: 5em;">
  <col width="160px;" />
  <col />
  <tbody>
    <tr>
      <td><strong>Average mark</strong></td>
      <td><strong>Grade</strong></td>
    </tr>
    <tr>
      <td>over 75</td>
      <td>A</td>
    </tr>
    <tr>
      <td>50 to 75</td>
      <td>B</td>
    </tr>
    <tr>
      <td>under 50</td>
      <td>C</td>
    </tr>
  </tbody>
</table>

<p>You could simply look at each mark and type in the appropriate grade.
However, the process can be simply automated by writing a formula which
calculates the grade, using the <strong>if()</strong> function.</p>

<p>The aim of our formula is to look at a mark and initially test whether it is
over 75. If it is, then the letter A will be printed in the column.
If not, the formula will test whether if the mark is between 50 and 75.
If it is then the letter B will be printed.
If not (i.e. it is less than 50), then the letter C will be printed.
The steps required to achieve this are spread over the next few sections.</p>

<ol>
<li>To start writing the formula containing the <strong>if()</strong> function,
click on the cell H3 and then place the caret the formula line either by
clicking in it or pressing
<span class="csguide-key">F2</span>.</li>

<img class="csguide-lhs-img" src="images/tbar_function_selector.png" />
<li>Click the
<span class="csguide-toolbar-button">Function selector</span> button,
then choose
<span class="csguide-menu-option">Quick...</span> from the menu which appears.</li>

<li>Double-click on the <strong>if(condition,then,else)</strong> entry in the list of functions presented to you and it will appear on the formula line.</li>
</ol>

<h4>Writing the condition</h4>

<p>The <strong>if()</strong> function has three parameters.</p>

<p>The first is the condition, i.e. the test which the formula applies to the mark.
If the condition is true, then the action detailed in the second parameter takes place.
If it is false, then the action detailed in the third parameter takes place.</p>

<p>You need to first test that the mark is greater than 75. To do this you simply
enter a comparison as the first parameter:

<blockquote><kbd>G3&gt;75</kbd></blockquote></p>

<p>Fireworkz will take the contents of the cell, and test to see if the answer
is true (i.e the contents of cell G3 are greater than 75),
or false (i.e. the contents of cell G3 are less than or equal to 75)
and act accordingly.</p>

<ol start="4">
<li>To enter the cell reference <kbd>G3</kbd>, simply point at that cell and
click the left mouse button.</li>

<li>Type in the rest of the condition:

<div class="csguide-li-div"><kbd>&gt;75</kbd></div>

<div class="csguide-li-div">The formula will now read:</div>

<div class="csguide-li-div"><kbd>if(G3&gt;75,then,else)</kbd></div></li>
</ol>

<h4>Printing a string</h4>

<p>Next you need to detail what will happen if the condition is true.
You want the letter A to appear in the cell, so you simply need to type this in.
Text manipulated by formulae needs to be surrounded by double quotes, so that
Fireworkz can recognise it and process it correctly. It is referred to as a
string because it is a string of characters.</p>

<ol start="6">
<li>Position the caret after the first comma.
As you move on to subsequent parameters, they will be highlighted and
appropriate help will appear in the status line.
As before, just type over the parameters to replace them.</li>

<li>Type over the <em>then</em> parameter:

<div class="csguide-li-div"><kbd>"A"</kbd></div>

<div class="csguide-li-div">The formula will now read:</div>

<div class="csguide-li-div"><kbd>if(G3&gt;75,&quot;A&quot;,else)</kbd></div></li>
</ol>

<p>Note that all parameters must be separated by commas, so that Fireworkz can tell them apart.</p>

<h4>Nesting if() functions</h4>

<p>The last stage is to enter what happens if the average mark is less than
75. In this case, a further test will be applied to the mark, to test whether
it is 50 or more. To write this part of the formula, you need to use a further
<strong>if()</strong> function. Placing one function inside another is known
as <em>nesting</em>.</p>

<p>There is no need to go back to the function selector; this time you should
try typing in the function directly:</p>

<ol start="8">
<li>Between the last comma and the closing bracket, type over the
<span class="csguide-parameter">else</span> parameter:

<div class="csguide-li-div"><kbd>if(,,)</kbd></div>

<div class="csguide-li-div">Your formula will now read:</div>

<div class="csguide-li-div"><kbd>if(G3&gt;75,&quot;A&quot;,if(,,))</kbd></div>

<div class="csguide-li-div">Make sure that you have the correct number of
brackets at the end of the formula - there should be two closing brackets next
to each other.</li>
</ol>

<p>The next stage is to enter the new condition, the first parameter to the
second <strong>if()</strong> function.
This time you will test whether the mark is greater than or equal to 50.</p>

<ol start="9">
<li>Type between the opening bracket and first comma of the second <strong>if()</strong> function:

<div class="csguide-li-div"><kbd>G3&gt;=50</kbd></div>

<div class="csguide-li-div">There is no need to test that the mark is under 75 as well because you have
already assigned a grade to those marks and this calculation will not be
performed on marks which met the condition in the first part of the function.</div>

<div class="csguide-li-div">Your formula will now read:</div>

<div class="csguide-li-div"><kbd>if(G3&gt;75,&quot;A&quot;,if(G3&gt;=50,,))</kbd></div>

<div class="csguide-li-div">The final stage is to enter what will be done if
this second condition is true or false. If it is true (i.e. the mark is between
50 and 75) you want to print the grade B; if it is false, the mark will be
neither over 75 nor 50 or over, so it must be under 50, and receive the grade C.</div>

<li>Type <kbd>&quot;B&quot;</kbd> for the second
(<span class="csguide-parameter">then</span>) parameter
and <kbd>&quot;C&quot;</kbd> for the third
(<span class="csguide-parameter">else</span>) parameter.

<div class="csguide-li-div">The finished function should look like this:</div>

<div class="csguide-li-div"><kbd>if(G3&gt;75,&quot;A&quot;,if(G3&gt;=50,&quot;B&quot;,&quot;C&quot;))</kbd></div></li>
</ol>

<h4>Evaluating the formula</h4>

<p>To evaluate the formula:</p>

<ol start="11">
<img class="csguide-lhs-img" src="images/tbar_tick.png" />
<li>Click the
<span class="csguide-toolbar-button">Tick</span> button on the toolbar or press
<span class="csguide-key">Return</span>.
You should see the result <kbd>A</kbd> appear in the cell containing the formula.
Note that the quotes are not displayed.
If you have made a mistake, then remove the formula as described earlier in this
chapter and either type in the correct formula shown in the previous step or repeat the prodcedure from the start.</li>
</ol>

<p>Finally, you need to perform the same calculation for each student in the
class. Again, you can use the
<span class="csguide-toolbar-button">Fill down</span> button to do this.</p>

<ol start="12">
<img class="csguide-lhs-img" src="images/tbar_fill_down.png" />
<li>Select the range of cells from cell H3 down to cell H18 and click the
<span class="csguide-toolbar-button">Fill down</span> button on the toolbar.
The column will fill with the grades for each student.</li>
</ol>

<h2>Analysing information</h2>

<p>The next stage is to analyse the information on the grades for the class as a
whole. You need to count the number of students with each of the grades.</p>

<p>The easiest way to do this is to use one of the database spreadsheet
functions. Database spreadsheet functions make a selection from a set of
records and perform a calculation on the selection.</p>

<p>You need to find the students with each grade and simply count how many
there are, so the <strong>dcounta()</strong> function is the one to use.</p>

<ol>
<li>Click on cell B23, and click on the formula line to place the caret there.</li>

<img class="csguide-lhs-img" src="images/tbar_function_selector.png" />
<li>Click the
<span class="csguide-toolbar-button">Function selector</span> button on the toolbar, and then open the
<span class="csguide-menu">Categories</span> submenu. Choose the
<span class="csguide-menu-option">Database</span> category, then locate and
double-click on the
<span class="csguide-list-option">dcounta(range,condition)</span> entry in
the list of database functions presented.</li>

<li>This function has two parameters; the first gives the range of cells on
which the function is to operate and the second gives the condition to be applied
to make the selection. In this case the range of cells are those cells
containing the grades, cells H3 to H18. Type the following as the first
(<span class="csguide-parameter">range</span>) parameter:

<div class="csguide-li-div"><kbd>H$3H$18</kbd></div>

<div class="csguide-li-div">Note that inserting the dollar signs in the
cell reference means that the following part of the cell reference
(here, the row part) will not be changed when the formula is copied using the
<span class="csguide-toolbar-button">Fill down</span> button, but remain
unchanged so as to always refer to the cells containing the student grades.</div></li>

<li>After the comma, type the following as the second
(<span class="csguide-parameter">condition</span>) parameter:

<div class="csguide-li-div"><kbd>H$3H$18=&quot;A&quot;</kbd></div>

<div class="csguide-li-div">Note that you need to enter the quote marks
around the text string for Fireworkz to recognise it as such.</div>

<div class="csguide-li-div">The finished formula should look like this:</div>

<div class="csguide-li-div"><kbd>dcounta(H$3H$18,H$3H$18=&quot;A&quot;)</kbd></div></li>

<img class="csguide-lhs-img" src="images/tbar_tick.png" />
<li>Click the
<span class="csguide-toolbar-button">Tick</span> button on the toolbar or press
<span class="csguide-key">Return</span>. The answer 2.00 should appear in
cell B23.</li>

<img class="csguide-lhs-img" src="images/tbar_fill_down.png" />
<li>Select the range of cells from cell B23 down to cell B25 and click the
<span class="csguide-toolbar-button">Fill down</span> button on the toolbar.</li>

<li>In cell B24 you are looking for students with grade B,
and in cell B25 looking for students with grade C.
Edit the formulae in these cells to contain the correct letter.
The formulae will be identical to that in B23 except that the final text string
(i.e. the grade) will differ.</li>
</ol>

<h2>Using operators</h2>

<p>As a finishing touch, you can display the information about the number of students with each grade category as a percentage.</p>

<p>There are two parts to this process. First you need to calculate the
proportion of students with each grade as a fraction, then you need to use a
percentage style to format and display the result correctly.</p>

<p>To calculate the proportion with each grade you simply divide the number of
students with that grade by the total number of students. For simple arithmetic operations such as this, you use the arithmetic operators
<kbd>+</kbd>, <kbd>-</kbd>, <kbd>*</kbd> and <kbd>/</kbd>.</p>

<ol>
<li>Click on cell C23, and place the caret in the formula line.</li>

<li>Click on cell B23. You will see <kbd>B23</kbd> appear in the formula line as if you had typed it.</li>

<li>You need to divide this number by the total number of students, which you
can work out using the <strong>counta()</strong> function, so type in:

<div class="csguide-li-div"><kbd>/counta(A$3A$18)</kbd></div>

<div class="csguide-li-div">Note the use of the dollar sign again to ensure that the cell reference does not change when the formula is copied.</div></li>

<img class="csguide-lhs-img" src="images/tbar_tick.png" />
<li>Click the
<span class="csguide-toolbar-button">Tick</span> button on the toolbar or press
<span class="csguide-key">Return</span>. The result 0.13 will appear in the cell.</li>

<img class="csguide-lhs-img" src="images/tbar_fill_down.png" />
<li>Select the range of cells from cell C23 down to cell C25 and click the
<span class="csguide-toolbar-button">Fill down</span> button on the toolbar
to calculate the remaining fractions.</li>
</ol>

<p>The second stage is to convert the fractions displayed into percentages.</p>

<ol>
<img class="csguide-lhs-img" src="images/tbar_style.png" />
<li>With the cells still selected, click the
<span class="csguide-toolbar-button">Style</span> button on the toolbar.</li>

<li>Choose
<span class="csguide-list-option">Percentage</span> from the list of styles
and click the
<span class="csguide-dbox-button">Apply</span> button.
The numbers will be displayed as a percentage. In this case, this means that
they are multiplied by 100, and shown with no decimal places and a percentage sign placed after them.</li>
</ol>

<h2>Updating information</h2>

<p>The advantage of using a spreadsheet instead of a pencil and paper is the
ease with which information can be recalculated.</p>

<p>After all the marks have been gathered and the analysis completed, news
comes in that the external moderators have changed the marks for some English
students.</p>

<ol>
<li>Click on cell B3. Change the number it contains to <kbd>65</kbd>.
This changes the average score to under 75, and so changes the grade for that
student, the number of students with each grade and the percentage of students with each grade.

<div class="csguide-li-div">All the calculations will be updated
almost instantaneously.</div></li>
</ol>

<h2>Summary</h2>

<p>In this chapter you learned how to write formulae, including the following
stages:</p>

<ul>
<li>Using the function selector</li>

<li>Typing in functions on the formula line</li>

<li>Using arithmetic and logical operators</li>

<li>Using the Fill buttons with functions</li>

<li>Using database spreadsheet functions</li>
</ul>

<p>The Spreadsheet Guide contains more information on using functions and
operators and writing formulas, as well as full details of each function,
including its parameters.</p>

<p>You can also access information on functions through the function reference
section of the on-line help system.</p>

<div class="navfooter">
<hr/>
<table width="100%" summary="Navigation footer">
<col width="40%">
<col width="20%">
<col width="40%">
<tr>
<td align="left"><a accesskey="p" href="gsg5.htm">Prev</a> </td>
<td align="center"> </td>
<td align="right"> <a accesskey="n" href="gsg7.htm">Next</a></td>
</tr>
<tr>
<td align="left" valign="top">Getting started with spreadsheets </td>
<td align="center"><a accesskey="h" href="gsgindex.htm">Home</a></td>
<td align="right" valign="top"> Advanced features</td>
</tr>
</table>
</div>
</body>
</html>
