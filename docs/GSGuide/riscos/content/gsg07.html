<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
    <meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />
    <title>Writing Formulae</title>
    <link href="guide.css" rel="stylesheet" type="text/css" />
</head>
<body>
    <!-- This Source Code Form is subject to the terms of the Mozilla Public
       - License, v. 2.0. If a copy of the MPL was not distributed with this
       - file, You can obtain one at http://mozilla.org/MPL/2.0/. -->
    <!-- Copyright (C) 1994-1998 Colton Software Limited
       - Copyright (C) 1998-2015 R W Colton -->
    <div class="navheader">
        <table id="navheader" summary="Navigation header">
            <tr>
                <td class="navheader_PCN_L"><a href="gsg06.html">Prev</a> </td>
                <th class="navheader_PCN_C">Fireworkz and Fireworkz Pro</th>
                <td class="navheader_PCN_R"> <a href="gsg08.html">Next</a></td>
            </tr>
            <tr>
                <td class="navheader_PCN_L">Getting started with spreadsheets </td>
                <th class="navheader_PCN_C">Getting Started Guide</th>
                <td class="navheader_PCN_R"> Advanced features</td>
            </tr>
        </table>
    </div>

    <h1><span class="csg-chapter-number">7 </span>Writing Formulae</h1>

    <p>
        This chapter introduces formulae and shows you how to write them. It
        introduces the operators and functions which you need to use in formulae and
        shows you the ways Fireworkz can help you to write formulae quickly and easily.
    </p>

    <p>It includes sections on:</p>
    <ol>
        <li>The function selector</li>
        <li>The if() function</li>
        <li>Analysis functions</li>
        <li>Arithmetic operators</li>
    </ol>

    <h2>Using functions</h2>

    <p>
        Load the spreadsheet <var>exams</var> from the <var>Tutorial</var> directory.
        You will see a list of class members and their marks in four exams.
    </p>

    <p>
        You need to calculate the average mark for each pupil, and to award them
        each a single grade based on this average mark. You then need to work out the
        number of pupils receiving each grade, and the percentage of the class
        receiving each grade.
    </p>

    <h3>The function selector</h3>

    <p>
        In the previous chapter you added columns of numbers using the
        <span class="csg-toolbar-button">Autosum</span> button.
        You saw that this created a formula which you could read on the formula line.
        In this chapter, you will be entering formulae directly on the formula line.
        Note that unlike text and numbers, you cannot enter a formula directly into a
        cell - you have to use the formula line.
    </p>

    <h4>Working out an average</h4>

    <p>
        The first step is to work out the average number of marks earned by each
        student:
    </p>

    <ol>
        <li>
            Click in cell G3. You need to add the <strong>avg()</strong> function to
            this cell. You can type in functions directly, but an easier method is to use
            the function selector.
        </li>

        <li>
            Click in the formula line to place the caret appear there. You can also do
            this by pressing the
            <span class="csg-key">F2</span> function key.
        </li>

        <li>
            <img class="csg-lhs-img" src="images/toolbar/selfnc.png" alt="Function selector tool button" />
            Click the
            <span class="csg-toolbar-button">Function selector</span> tool button on the toolbar.
        </li>

        <li>
            Choose
            <span class="csg-menu-option">Quick</span> from the function selector
            menu by clicking on it. You will see a short list of functions.
        </li>

        <li>
            Double-click on the <strong>avg(list)</strong> entry in this list.
            It will appear on the formula line.
        </li>

        <li>
            The word <span class="csg-function-parameter">list</span> is called the
            <em>parameter</em> to the function.
            You need to replace it with the actual data on which the function will operate.
            The <strong>avg()</strong> function needs a list of numbers to operate
            on. You could supply a list of individual cell references, but in this case you
            will supply a range, indicating that the function should operate on the data
            in all the cells contained between, and including, the two cell references
            given.

            <br /><span>You could enter the range details by typing in the top left and bottom right cell referencess in the range, but it is easier to use the mouse.</span>
        </li>

        <li>
            Select the range of cells starting at cell B3 and ending at cell E3.
            You will see these cell references appear between the brackets in the formula
            on the formula line, replacing
            <span class="csg-function-parameter">list</span>.
        </li>

        <li>
            <img class="csg-lhs-img" src="images/toolbar/tick.png" alt="Tick tool button" />
            Your formula is now complete. Click the
            <span class="csg-toolbar-button">Tick</span> tool button on the toolbar or press
            <span class="csg-key">Return&crarr;</span> to enter the formula. You will see the result 76.75 appear in the cell.
        </li>
    </ol>

    <h4>If you make a mistake</h4>

    <p>
        If you make a mistake and the correct result does not appear, then you need
        to change the formula:
    </p>

    <ol>
        <li>Click in cell G3.</li>

        <li>
            Click in the formula line to place the caret appear there or press
            <span class="csg-key">F2</span>.
        </li>

        <li>Delete the current formula.</li>

        <li>
            Type in the correct formula:

            <br /><span><span class="csg-user-text">avg(b3e3)</span></span>
        </li>

        <li>
            <img class="csg-lhs-img" src="images/toolbar/tick.png" alt="Tick tool button" />
            Click the
            <span class="csg-toolbar-button">Tick</span> tool button on the toolbar or press
            <span class="csg-key">Return&crarr;</span> to enter the corrected formula.
        </li>
    </ol>

    <h4>Repeating a calculation</h4>

    <p>
        <img class="csg-lhs-img" src="images/toolbar/fill_r.png" alt="Fill right tool button" />
        You need to perform the same calculation for all the students in the class.
        This can be done using one of the
        <span class="csg-toolbar-button">Fill</span> buttons.
    </p>

    <p>
        <img class="csg-lhs-img" src="images/toolbar/fill_d.png" alt="Fill down tool button" />
        When you use a
        <span class="csg-toolbar-button">Fill</span> button to copy a formula,
        it updates the formula in each column or row, so that the data it operates on
        has the same relative position to each cell containing the formula.
        So when our formula appears in row 4, it will calculate the average value in
        row 4, and so on:
    </p>

    <ol>
        <li>Select the range of cells from cell G3 down to cell G18.</li>

        <li>
            <img class="csg-lhs-img" src="images/toolbar/fill_d.png" alt="Fill down tool button" />
            Now click the
            <span class="csg-toolbar-button">Fill down</span> button (because you are
            filling down a column). The column will fill with the average mark for each
            student.
        </li>
    </ol>

    <p>
        You can check the formulae which have been created by clicking on any of the
        cells in column G and looking at the formula which appears in the formula line.
    </p>

    <h3>The if() function</h3>

    <p>
        The next stage is to assign a grade to each student, based on their average
        mark. The school operates the following formula:
    </p>

    <table style="margin-left: 5em;">
        <colgroup>
            <col width="160px;" />
            <col />
        </colgroup>
        <tbody>
            <tr>
                <td><strong>Average mark</strong></td>
                <td><strong>Grade</strong></td>
            </tr>
            <tr>
                <td>over 75</td>
                <td>A</td>
            </tr>
            <tr>
                <td>50 to 75</td>
                <td>B</td>
            </tr>
            <tr>
                <td>under 50</td>
                <td>C</td>
            </tr>
        </tbody>
    </table>

    <p>
        You could simply look at each mark and type in the appropriate grade.
        However, the process can be simply automated by writing a formula which
        calculates the grade, using the <strong>if()</strong> function.
    </p>

    <p>
        The aim of our formula is to look at a mark and initially test whether it is
        over 75. If it is, then the letter A will be printed in the column.
        If not, the formula will test whether if the mark is between 50 and 75.
        If it is then the letter B will be printed.
        If not (i.e. it is less than 50), then the letter C will be printed.
        The steps required to achieve this are spread over the next few sections.
    </p>

    <ol>
        <li>
            To start writing the formula containing the <strong>if()</strong> function,
            click on cell H3 and then place the caret the formula line either by
            clicking in it or pressing
            <span class="csg-key">F2</span>.
        </li>

        <li>
            <img class="csg-lhs-img" src="images/toolbar/selfnc.png" alt="Function selector tool button" />
            Click the
            <span class="csg-toolbar-button">Function selector</span> button,
            then choose
            <span class="csg-menu-option">Quick</span> from the menu which appears.
        </li>

        <li>Double-click on the <strong>if(condition,then,else)</strong> entry in the list of functions presented to you and it will appear on the formula line.</li>
    </ol>

    <h4>Writing the condition</h4>

    <p>The <strong>if()</strong> function has three parameters.</p>

    <p>
        The first is the condition, i.e. the test which the formula applies to the mark.
        If the condition is true, then the action detailed in the second parameter takes place.
        If it is false, then the action detailed in the third parameter takes place.
    </p>

    <p>
        You need to first test that the mark is greater than 75. To do this you simply
        enter a comparison as the first parameter:
    </p>

    <blockquote class="csg-user-text">G3&gt;75</blockquote>

    <p>
        Fireworkz will take the contents of the cell, and test to see if the answer
        is true (i.e the contents of cell G3 are greater than 75),
        or false (i.e. the contents of cell G3 are less than or equal to 75)
        and act accordingly.
    </p>

    <!-- ol start="4" -->
    <ul class="csg-netsurf-2434">
        <li>
            <span class="csg-netsurf-2434-number">4.</span>
            To enter the cell reference <span class="csg-user-text">G3</span>, simply point at that cell and
            click the left mouse button.
        </li>

        <li>
            <span class="csg-netsurf-2434-number">5.</span>
            Type in the rest of the condition:

            <br /><span><span class="csg-user-text">&gt;75</span></span>

            <br /><span>The formula will now read:</span>

            <br /><span><span class="csg-user-text">if(G3&gt;75,then,else)</span></span>
        </li>
    </ul>

    <h4>Printing a string</h4>

    <p>
        Next you need to detail what will happen if the condition is true.
        You want the letter A to appear in the cell, so you simply need to type this in.
        Text manipulated by formulae needs to be surrounded by double quotes, so that
        Fireworkz can recognise it and process it correctly. It is referred to as a
        string because it is a string of characters.
    </p>

    <!-- ol start="6" -->
    <ul class="csg-netsurf-2434">
        <li>
            <span class="csg-netsurf-2434-number">6.</span>
            Position the caret after the first comma.
            As you move on to subsequent parameters, they will be highlighted and
            appropriate help will appear in the status line.
            As before, just type over the parameters to replace them.
        </li>

        <li>
            <span class="csg-netsurf-2434-number">7.</span>
            Type over the <em>then</em> parameter:

            <br /><span><span class="csg-user-text">"A"</span></span>

            <br /><span>The formula will now read:</span>

            <br /><span><span class="csg-user-text">if(G3&gt;75,&quot;A&quot;,else)</span></span>
        </li>
    </ul>

    <p>Note that all parameters must be separated by commas, so that Fireworkz can tell them apart.</p>

    <h4>Nesting if() functions</h4>

    <p>
        The last stage is to enter what happens if the average mark is less than
        75. In this case, a further test will be applied to the mark, to test whether
        it is 50 or more. To write this part of the formula, you need to use a further
        <strong>if()</strong> function. Placing one function inside another is known
        as <em>nesting</em>.
    </p>

    <p>
        There is no need to go back to the function selector; this time you should
        try typing in the function directly:
    </p>

    <!-- ol start="8" -->
    <ul class="csg-netsurf-2434">
        <li>
            <span class="csg-netsurf-2434-number">8.</span>
            Between the last comma and the closing bracket, type over the
            <span class="csg-function-parameter">else</span> parameter:

            <br /><span><span class="csg-user-text">if(,,)</span></span>

            <br /><span>Your formula will now read:</span>

            <br /><span><span class="csg-user-text">if(G3&gt;75,&quot;A&quot;,if(,,))</span></span>

            <br /><span>
                Make sure that you have the correct number of
                brackets at the end of the formula - there should be two closing brackets next
                to each other.
            </span>
        </li>
    </ul>

    <p>
        The next stage is to enter the new condition, the first parameter to the
        second <strong>if()</strong> function.
        This time you will test whether the mark is greater than or equal to 50.
    </p>

    <!-- ol start="9" -->
    <ul class="csg-netsurf-2434">
        <li>
            <span class="csg-netsurf-2434-number">9.</span>
            Type between the opening bracket and first comma of the second <strong>if()</strong> function:

            <br /><span><span class="csg-user-text">G3&gt;=50</span></span>

            <br /><span>
                There is no need to test that the mark is under 75 as well because you have
                already assigned a grade to those marks and this calculation will not be
                performed on marks which met the condition in the first part of the function.
            </span>

            <br /><span>Your formula will now read:</span>

            <br /><span><span class="csg-user-text">if(G3&gt;75,&quot;A&quot;,if(G3&gt;=50,,))</span></span>

            <br /><span>
                The final stage is to enter what will be done if
                this second condition is true or false. If it is true (i.e. the mark is between
                50 and 75) you want to print the grade B; if it is false, the mark will be
                neither over 75 nor 50 or over, so it must be under 50, and receive the grade C.
            </span>
        </li>

        <li>
            <span class="csg-netsurf-2434-number">10.</span>
            Type <span class="csg-user-text">&quot;B&quot;</span> for the second
            (<span class="csg-function-parameter">then</span>) parameter
            and <span class="csg-user-text">&quot;C&quot;</span> for the third
            (<span class="csg-function-parameter">else</span>) parameter.

            <br /><span>The finished function should look like this:</span>

            <br /><span><span class="csg-user-text">if(G3&gt;75,&quot;A&quot;,if(G3&gt;=50,&quot;B&quot;,&quot;C&quot;))</span></span>
        </li>
    </ul>

    <h4>Evaluating the formula</h4>

    <p>To evaluate the formula:</p>

    <!-- ol start="11" -->
    <ul class="csg-netsurf-2434">
        <li>
            <img class="csg-lhs-img" src="images/toolbar/tick.png" alt="Tick tool button" />
            <span class="csg-netsurf-2434-number">11.</span>
            Click the
            <span class="csg-toolbar-button">Tick</span> tool button on the toolbar or press
            <span class="csg-key">Return&crarr;</span>.
            You should see the result <span class="csg-user-text">A</span> appear in the cell containing the formula.
            Note that the quotes are not displayed.
            If you have made a mistake, then remove the formula as described earlier in this
            chapter and either type in the correct formula shown in the previous step or repeat the prodcedure from the start.
        </li>
    </ul>

    <p>
        Finally, you need to perform the same calculation for each student in the
        class. Again, you can use the
        <span class="csg-toolbar-button">Fill down</span> button to do this.
    </p>

    <!-- ol start="12" -->
    <ul class="csg-netsurf-2434">
        <li>
            <img class="csg-lhs-img" src="images/toolbar/fill_d.png" alt="Fill down tool button" />
            <span class="csg-netsurf-2434-number">12.</span>
            Select the range of cells from cell H3 down to cell H18 and click the
            <span class="csg-toolbar-button">Fill down</span> tool button on the toolbar.
            The column will fill with the grades for each student.
        </li>
    </ul>

    <h2>Analysing information</h2>

    <p>
        The next stage is to analyse the information on the grades for the class as a
        whole. You need to count the number of students with each of the grades.
    </p>

    <p>
        The easiest way to do this is to use one of the database spreadsheet
        functions. Database spreadsheet functions make a selection from a set of
        records and perform a calculation on the selection.
    </p>

    <p>
        You need to find the students with each grade and simply count how many
        there are, so the <strong>dcounta()</strong> function is the one to use.
    </p>

    <ol>
        <li>Click on cell B23, and click on the formula line to place the caret there.</li>

        <li>
            <img class="csg-lhs-img" src="images/toolbar/selfnc.png" alt="Function selector tool button" />
            Click the
            <span class="csg-toolbar-button">Function selector</span> tool button on the toolbar, then choose the
            <span class="csg-menu-option">Database</span> category from the
            <span class="csg-menu">Categories</span> sub-menu.
            Then locate and double-click on the
            <span class="csg-list-option">dcounta(range,condition)</span> entry in
            the list of database functions presented.
        </li>

        <li>
            This function has two parameters; the first gives the range of cells on
            which the function is to operate and the second gives the condition to be applied
            to make the selection. In this case the range of cells are those cells
            containing the grades, cells H3 to H18. Type the following as the first
            (<span class="csg-function-parameter">range</span>) parameter:

            <br /><span><span class="csg-user-text">H$3H$18</span></span>

            <br /><span>
                Note that inserting the dollar signs in the
                cell reference means that the following part of the cell reference
                (here, the row part) will not be changed when the formula is copied using the
                <span class="csg-toolbar-button">Fill down</span> button, but remain
                unchanged so as to always refer to the cells containing the student grades.
            </span>
        </li>

        <li>
            After the comma, type the following as the second
            (<span class="csg-function-parameter">condition</span>) parameter:

            <br /><span><span class="csg-user-text">H$3H$18=&quot;A&quot;</span></span>

            <br /><span>
                Note that you need to enter the quote marks
                around the text string for Fireworkz to recognise it as such.
            </span>

            <br /><span>The finished formula should look like this:</span>

            <br /><span><span class="csg-user-text">dcounta(H$3H$18,H$3H$18=&quot;A&quot;)</span></span>
        </li>

        <li>
            <img class="csg-lhs-img" src="images/toolbar/tick.png" alt="Tick tool button" />
            Click the
            <span class="csg-toolbar-button">Tick</span> tool button on the toolbar or press
            <span class="csg-key">Return&crarr;</span>. The answer 2.00 should appear in
            cell B23.
        </li>

        <li>
            <img class="csg-lhs-img" src="images/toolbar/fill_d.png" alt="Fill down tool button" />
            Select the range of cells from cell B23 down to cell B25 and click the
            <span class="csg-toolbar-button">Fill down</span> tool button on the toolbar.
        </li>

        <li>
            In cell B24 you are looking for students with grade B,
            and in cell B25 looking for students with grade C.
            Edit the formulae in these cells to contain the correct letter.
            The formulae will be identical to that in B23 except that the final text string
            (i.e. the grade) will differ.
        </li>
    </ol>

    <h2>Using operators</h2>

    <p>As a finishing touch, you can display the information about the number of students with each grade category as a percentage.</p>

    <p>
        There are two parts to this process. First you need to calculate the
        proportion of students with each grade as a fraction, then you need to use a
        percentage style to format and display the result correctly.
    </p>

    <p>
        To calculate the proportion with each grade you simply divide the number of
        students with that grade by the total number of students. For simple arithmetic operations such as this, you use the arithmetic operators
        <span class="csg-user-text">+</span>, <span class="csg-user-text">-</span>, <span class="csg-user-text">*</span> and <span class="csg-user-text">/</span>.
    </p>

    <ol>
        <li>Click on cell C23, and place the caret in the formula line.</li>

        <li>Click on cell B23. You will see <span class="csg-user-text">B23</span> appear in the formula line as if you had typed it.</li>

        <li>
            You need to divide this number by the total number of students, which you
            can work out using the <strong>counta()</strong> function, so type in:

            <br /><span><span class="csg-user-text">/counta(A$3A$18)</span></span>

            <br /><span>Note the use of the dollar sign again to ensure that the cell reference does not change when the formula is copied.</span>
        </li>

        <li>
            <img class="csg-lhs-img" src="images/toolbar/tick.png" alt="Tick tool button" />
            Click the
            <span class="csg-toolbar-button">Tick</span> tool button on the toolbar or press
            <span class="csg-key">Return&crarr;</span>. The result 0.13 will appear in the cell.
        </li>

        <li>
            <img class="csg-lhs-img" src="images/toolbar/fill_d.png" alt="Fill down tool button" />
            Select the range of cells from cell C23 down to cell C25 and click the
            <span class="csg-toolbar-button">Fill down</span> tool button on the toolbar
            to calculate the remaining fractions.
        </li>
    </ol>

    <p>The second stage is to convert the fractions displayed into percentages.</p>

    <ol>
        <li>
            <img class="csg-lhs-img" src="images/toolbar/style.png" alt="Style tool button" />
            With the cells still selected, click the
            <span class="csg-toolbar-button">Style</span> tool button on the toolbar.
        </li>

        <li>
            Choose
            <span class="csg-list-option">Percentage</span> from the list of styles
            and click the
            <span class="csg-dbox-button-default"><span class="csg-dbox-button-core">Apply</span></span> button.
            The numbers will be displayed as a percentage. In this case, this means that
            they are multiplied by 100, and shown with no decimal places and a percentage sign placed after them.
        </li>
    </ol>

    <h2>Updating information</h2>

    <p>
        The advantage of using a spreadsheet instead of a pencil and paper is the
        ease with which information can be recalculated.
    </p>

    <p>
        After all the marks have been gathered and the analysis completed, news
        comes in that the external moderators have changed the marks for some English
        students.
    </p>

    <ol>
        <li>
            Click on cell B3. Change the number it contains to <span class="csg-user-text">65</span>.
            This changes the average score to under 75, and so changes the grade for that
            student, the number of students with each grade and the percentage of students with each grade.

            <br /><span>All the calculations will be updated almost instantaneously.</span>
        </li>
    </ol>

    <h2>Summary</h2>

    <p>
        In this chapter you learned how to write formulae, including the following
        stages:
    </p>

    <ul>
        <li>Using the function selector</li>

        <li>Typing in functions on the formula line</li>

        <li>Using arithmetic and logical operators</li>

        <li>Using the Fill buttons with functions</li>

        <li>Using database spreadsheet functions</li>
    </ul>

    <p>
        The <em>User Guide</em> contains more information on using functions and
        operators and writing formulae, as well as full details of each function,
        including its parameters.
    </p>

    <p>
        You can also access information on functions through the function reference
        section of the on-line help system.
    </p>

    <div class="navfooter">
        <table id="navfooter" summary="Navigation footer">
            <tr>
                <td class="navfooter_PUN_L"><a accesskey="p" href="gsg06.html">Prev</a> </td>
                <td class="navfooter_PUN_C"> </td>
                <td class="navfooter_PUN_R"> <a accesskey="n" href="gsg08.html">Next</a></td>
            </tr>
            <tr>
                <td class="navfooter_PUN_L">Getting started with spreadsheets </td>
                <td class="navfooter_PUN_C"><a accesskey="h" href="../index.html">Home</a></td>
                <td class="navfooter_PUN_R"> Advanced features</td>
            </tr>
        </table>
    </div>
</body>
</html>
